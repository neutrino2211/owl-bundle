{"id":"Fylr","dependencies":[{"name":"/home/tbranyen/git/diffhtml/packages/diffhtml/package.json","includedInParent":true,"mtime":1534977442154},{"name":"/home/tbranyen/git/diffhtml/packages/diffhtml/.babelrc","includedInParent":true,"mtime":1534634600429},{"name":"../util/caches","loc":{"line":1,"column":26},"parent":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/tasks/reconcile-trees.js","resolved":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/util/caches.js"},{"name":"../util/memory","loc":{"line":2,"column":45},"parent":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/tasks/reconcile-trees.js","resolved":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/util/memory.js"},{"name":"../tree/create","loc":{"line":3,"column":23},"parent":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/tasks/reconcile-trees.js","resolved":"/home/tbranyen/git/diffhtml/packages/diffhtml/lib/tree/create.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=u;var e=require(\"../util/caches\"),r=require(\"../util/memory\"),o=require(\"../tree/create\"),t=d(o);function d(e){return e&&e.__esModule?e:{default:e}}function u(o){var d=o.state,u=o.domNode,a=o.markup,l=o.options,n=d.previousMarkup,T=l.inner,i=u.outerHTML;if(n===i&&d.oldTree&&i||(d.oldTree&&(0,r.unprotectVTree)(d.oldTree),d.oldTree=(0,t.default)(u),e.NodeCache.set(d.oldTree,u),(0,r.protectVTree)(d.oldTree)),o.oldTree=d.oldTree,o.newTree||(o.newTree=(0,t.default)(a)),T){var s=o.oldTree,c=o.newTree,p=(s.rawNodeName,s.nodeName),f=s.attributes,N=\"string\"!=typeof c.rawNodeName,m=11===c.nodeType&&!N?c.childNodes:c;o.newTree=(0,t.default)(p,f,m)}}","map":{"mappings":[{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":0}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":13}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":20}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":35}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":43}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":56}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":57}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":64}},{"source":"tasks/reconcile-trees.js","name":"reconcileTrees","original":{"line":5,"column":24},"generated":{"line":1,"column":68}},{"source":"tasks/reconcile-trees.js","name":"reconcileTrees","original":{"line":5,"column":24},"generated":{"line":1,"column":76}},{"source":"tasks/reconcile-trees.js","name":"reconcileTrees","original":{"line":5,"column":24},"generated":{"line":1,"column":84}},{"source":"tasks/reconcile-trees.js","original":{"line":1,"column":0},"generated":{"line":1,"column":86}},{"source":"tasks/reconcile-trees.js","original":{"line":1,"column":0},"generated":{"line":1,"column":90}},{"source":"tasks/reconcile-trees.js","original":{"line":1,"column":0},"generated":{"line":1,"column":92}},{"source":"tasks/reconcile-trees.js","original":{"line":1,"column":0},"generated":{"line":1,"column":100}},{"source":"tasks/reconcile-trees.js","original":{"line":2,"column":0},"generated":{"line":1,"column":118}},{"source":"tasks/reconcile-trees.js","original":{"line":2,"column":0},"generated":{"line":1,"column":120}},{"source":"tasks/reconcile-trees.js","original":{"line":2,"column":0},"generated":{"line":1,"column":128}},{"source":"tasks/reconcile-trees.js","original":{"line":3,"column":0},"generated":{"line":1,"column":146}},{"source":"tasks/reconcile-trees.js","original":{"line":3,"column":0},"generated":{"line":1,"column":148}},{"source":"tasks/reconcile-trees.js","original":{"line":3,"column":0},"generated":{"line":1,"column":156}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":174}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":176}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":178}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":181}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":190}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":192}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":195}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":202}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":205}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":207}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":218}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":220}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":221}},{"source":"tasks/reconcile-trees.js","original":{"line":44,"column":1},"generated":{"line":1,"column":229}},{"source":"tasks/reconcile-trees.js","original":{"line":5,"column":15},"generated":{"line":1,"column":232}},{"source":"tasks/reconcile-trees.js","name":"reconcileTrees","original":{"line":5,"column":24},"generated":{"line":1,"column":241}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":5,"column":39},"generated":{"line":1,"column":243}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":6,"column":10},"generated":{"line":1,"column":246}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":6,"column":10},"generated":{"line":1,"column":250}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":6,"column":46},"generated":{"line":1,"column":252}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":6,"column":10},"generated":{"line":1,"column":254}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":6,"column":17},"generated":{"line":1,"column":260}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":6,"column":46},"generated":{"line":1,"column":262}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":6,"column":17},"generated":{"line":1,"column":264}},{"source":"tasks/reconcile-trees.js","name":"markup","original":{"line":6,"column":26},"generated":{"line":1,"column":272}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":6,"column":46},"generated":{"line":1,"column":274}},{"source":"tasks/reconcile-trees.js","name":"markup","original":{"line":6,"column":26},"generated":{"line":1,"column":276}},{"source":"tasks/reconcile-trees.js","name":"options","original":{"line":6,"column":34},"generated":{"line":1,"column":283}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":6,"column":46},"generated":{"line":1,"column":285}},{"source":"tasks/reconcile-trees.js","name":"options","original":{"line":6,"column":34},"generated":{"line":1,"column":287}},{"source":"tasks/reconcile-trees.js","name":"previousMarkup","original":{"line":7,"column":10},"generated":{"line":1,"column":295}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":7,"column":29},"generated":{"line":1,"column":297}},{"source":"tasks/reconcile-trees.js","name":"previousMarkup","original":{"line":7,"column":10},"generated":{"line":1,"column":299}},{"source":"tasks/reconcile-trees.js","name":"inner","original":{"line":8,"column":10},"generated":{"line":1,"column":314}},{"source":"tasks/reconcile-trees.js","name":"options","original":{"line":8,"column":20},"generated":{"line":1,"column":316}},{"source":"tasks/reconcile-trees.js","name":"inner","original":{"line":8,"column":10},"generated":{"line":1,"column":318}},{"source":"tasks/reconcile-trees.js","name":"outerHTML","original":{"line":9,"column":10},"generated":{"line":1,"column":324}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":9,"column":24},"generated":{"line":1,"column":326}},{"source":"tasks/reconcile-trees.js","name":"outerHTML","original":{"line":9,"column":10},"generated":{"line":1,"column":328}},{"source":"tasks/reconcile-trees.js","name":"inner","original":{"line":35,"column":6},"generated":{"line":1,"column":338}},{"source":"tasks/reconcile-trees.js","name":"previousMarkup","original":{"line":13,"column":6},"generated":{"line":1,"column":341}},{"source":"tasks/reconcile-trees.js","name":"outerHTML","original":{"line":13,"column":25},"generated":{"line":1,"column":345}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":13,"column":39},"generated":{"line":1,"column":348}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":13,"column":45},"generated":{"line":1,"column":350}},{"source":"tasks/reconcile-trees.js","name":"outerHTML","original":{"line":13,"column":57},"generated":{"line":1,"column":359}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":14,"column":8},"generated":{"line":1,"column":363}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":14,"column":14},"generated":{"line":1,"column":365}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":15,"column":21},"generated":{"line":1,"column":375}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":15,"column":21},"generated":{"line":1,"column":377}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":15,"column":21},"generated":{"line":1,"column":379}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":15,"column":21},"generated":{"line":1,"column":395}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":15,"column":27},"generated":{"line":1,"column":397}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":18,"column":10},"generated":{"line":1,"column":406}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":18,"column":10},"generated":{"line":1,"column":408}},{"source":"tasks/reconcile-trees.js","original":{"line":18,"column":20},"generated":{"line":1,"column":417}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":18,"column":31},"generated":{"line":1,"column":419}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":18,"column":31},"generated":{"line":1,"column":421}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":18,"column":31},"generated":{"line":1,"column":430}},{"source":"tasks/reconcile-trees.js","name":"set","original":{"line":19,"column":14},"generated":{"line":1,"column":433}},{"source":"tasks/reconcile-trees.js","name":"set","original":{"line":19,"column":14},"generated":{"line":1,"column":435}},{"source":"tasks/reconcile-trees.js","name":"set","original":{"line":19,"column":14},"generated":{"line":1,"column":445}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":19,"column":18},"generated":{"line":1,"column":449}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":19,"column":24},"generated":{"line":1,"column":451}},{"source":"tasks/reconcile-trees.js","name":"domNode","original":{"line":19,"column":33},"generated":{"line":1,"column":459}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":20,"column":17},"generated":{"line":1,"column":463}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":20,"column":17},"generated":{"line":1,"column":465}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":20,"column":17},"generated":{"line":1,"column":467}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":20,"column":17},"generated":{"line":1,"column":481}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":20,"column":23},"generated":{"line":1,"column":483}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":24,"column":14},"generated":{"line":1,"column":493}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":24,"column":14},"generated":{"line":1,"column":495}},{"source":"tasks/reconcile-trees.js","name":"state","original":{"line":24,"column":24},"generated":{"line":1,"column":503}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":24,"column":30},"generated":{"line":1,"column":505}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":29,"column":7},"generated":{"line":1,"column":513}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":29,"column":19},"generated":{"line":1,"column":515}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":30,"column":16},"generated":{"line":1,"column":525}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":30,"column":16},"generated":{"line":1,"column":527}},{"source":"tasks/reconcile-trees.js","original":{"line":30,"column":26},"generated":{"line":1,"column":536}},{"source":"tasks/reconcile-trees.js","name":"markup","original":{"line":30,"column":37},"generated":{"line":1,"column":538}},{"source":"tasks/reconcile-trees.js","name":"markup","original":{"line":30,"column":37},"generated":{"line":1,"column":540}},{"source":"tasks/reconcile-trees.js","name":"markup","original":{"line":30,"column":37},"generated":{"line":1,"column":549}},{"source":"tasks/reconcile-trees.js","name":"inner","original":{"line":35,"column":6},"generated":{"line":1,"column":553}},{"source":"tasks/reconcile-trees.js","original":{"line":35,"column":13},"generated":{"line":1,"column":555}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":36,"column":12},"generated":{"line":1,"column":556}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":36,"column":12},"generated":{"line":1,"column":560}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":36,"column":33},"generated":{"line":1,"column":562}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":36,"column":12},"generated":{"line":1,"column":564}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":36,"column":21},"generated":{"line":1,"column":572}},{"source":"tasks/reconcile-trees.js","name":"transaction","original":{"line":36,"column":33},"generated":{"line":1,"column":574}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":36,"column":21},"generated":{"line":1,"column":576}},{"source":"tasks/reconcile-trees.js","name":"nodeName","original":{"line":37,"column":25},"generated":{"line":1,"column":584}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":37,"column":50},"generated":{"line":1,"column":587}},{"source":"tasks/reconcile-trees.js","name":"rawNodeName","original":{"line":37,"column":12},"generated":{"line":1,"column":589}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":37,"column":50},"generated":{"line":1,"column":601}},{"source":"tasks/reconcile-trees.js","name":"nodeName","original":{"line":37,"column":25},"generated":{"line":1,"column":603}},{"source":"tasks/reconcile-trees.js","name":"attributes","original":{"line":37,"column":35},"generated":{"line":1,"column":613}},{"source":"tasks/reconcile-trees.js","name":"oldTree","original":{"line":37,"column":50},"generated":{"line":1,"column":615}},{"source":"tasks/reconcile-trees.js","name":"attributes","original":{"line":37,"column":35},"generated":{"line":1,"column":617}},{"source":"tasks/reconcile-trees.js","name":"isUnknown","original":{"line":38,"column":10},"generated":{"line":1,"column":628}},{"source":"tasks/reconcile-trees.js","original":{"line":38,"column":53},"generated":{"line":1,"column":630}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":38,"column":29},"generated":{"line":1,"column":647}},{"source":"tasks/reconcile-trees.js","name":"rawNodeName","original":{"line":38,"column":37},"generated":{"line":1,"column":649}},{"source":"tasks/reconcile-trees.js","name":"children","original":{"line":40,"column":10},"generated":{"line":1,"column":661}},{"source":"tasks/reconcile-trees.js","original":{"line":39,"column":44},"generated":{"line":1,"column":663}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":39,"column":23},"generated":{"line":1,"column":668}},{"source":"tasks/reconcile-trees.js","name":"nodeType","original":{"line":39,"column":31},"generated":{"line":1,"column":670}},{"source":"tasks/reconcile-trees.js","name":"isUnknown","original":{"line":40,"column":36},"generated":{"line":1,"column":681}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":40,"column":48},"generated":{"line":1,"column":683}},{"source":"tasks/reconcile-trees.js","name":"childNodes","original":{"line":40,"column":56},"generated":{"line":1,"column":685}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":40,"column":69},"generated":{"line":1,"column":696}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":42,"column":16},"generated":{"line":1,"column":698}},{"source":"tasks/reconcile-trees.js","name":"newTree","original":{"line":42,"column":16},"generated":{"line":1,"column":700}},{"source":"tasks/reconcile-trees.js","original":{"line":42,"column":26},"generated":{"line":1,"column":709}},{"source":"tasks/reconcile-trees.js","name":"nodeName","original":{"line":42,"column":37},"generated":{"line":1,"column":711}},{"source":"tasks/reconcile-trees.js","name":"nodeName","original":{"line":42,"column":37},"generated":{"line":1,"column":713}},{"source":"tasks/reconcile-trees.js","name":"nodeName","original":{"line":42,"column":37},"generated":{"line":1,"column":722}},{"source":"tasks/reconcile-trees.js","name":"attributes","original":{"line":42,"column":47},"generated":{"line":1,"column":724}},{"source":"tasks/reconcile-trees.js","name":"children","original":{"line":42,"column":59},"generated":{"line":1,"column":726}}],"sources":{"tasks/reconcile-trees.js":"import { NodeCache } from '../util/caches';\nimport { protectVTree, unprotectVTree } from '../util/memory';\nimport createTree from '../tree/create';\n\nexport default function reconcileTrees(transaction) {\n  const { state, domNode, markup, options } = transaction;\n  const { previousMarkup } = state;\n  const { inner } = options;\n  const { outerHTML } = domNode;\n\n  // We rebuild the tree whenever the DOM Node changes, including the first\n  // time we patch a DOM Node.\n  if (previousMarkup !== outerHTML || !state.oldTree || !outerHTML) {\n    if (state.oldTree) {\n      unprotectVTree(state.oldTree);\n    }\n\n    state.oldTree = createTree(domNode);\n    NodeCache.set(state.oldTree, domNode);\n    protectVTree(state.oldTree);\n  }\n\n  // Associate the old tree with this brand new transaction.\n  transaction.oldTree = state.oldTree;\n\n  // If we are in a render transaction where no markup was previously parsed\n  // then reconcile trees will attempt to create a tree based on the incoming\n  // markup (JSX/html/etc).\n  if (!transaction.newTree) {\n    transaction.newTree = createTree(markup);\n  }\n\n  // If we are diffing only the parent's childNodes, then adjust the newTree to\n  // be a replica of the oldTree except with the childNodes changed.\n  if (inner) {\n    const { oldTree, newTree } = transaction;\n    const { rawNodeName, nodeName, attributes } = oldTree;\n    const isUnknown = typeof newTree.rawNodeName !== 'string';\n    const isFragment = newTree.nodeType === 11;\n    const children = isFragment && !isUnknown ? newTree.childNodes : newTree;\n\n    transaction.newTree = createTree(nodeName, attributes, children);\n  }\n}\n"},"lineCount":null}},"hash":"11f67f2564fb1823ebace6d2fc0a64e1","cacheData":{"env":{}}}